# INSHack2017 rsa16m Write-up

## 题目观察
- 附件提供文本 `rsa_16m`，内含 $n,c,e$ 三个参数，且 $n$、$c$ 皆以 16 进制给出。根据统计，$n$ 的位长约 $1.6769\times 10^7$ 位。
- 公钥指数 $e = 17$ 异常地小；若明文未经过填充且 $m^e < n$，则密文不会发生模运算截断。

## 解题思路
1. 将文件解析为 Python 大整数。Python 对于数百万位整数也能处理。
2. 判断是否满足 $c = m^e$。直接调用 `gmpy2.iroot(c, e)` 计算整数 $e$ 次方根，可同时返回“是否为完美幂”的布尔值。
3. 若返回精确的根，说明假设成立，所得根即是原始明文整数。将其转换为字节串并解码为 ASCII 即可。

## 关键推理
- 因为 $m$ 表示 flag，长度有限（不到百字节），其位数至多数百，于是 $m^{17}$ 的位长约 $O(10^3)$。题中 $n$ 的位长反而远大于此，因此 $m^{17} < n$，模运算相当于原样返回。
- 通过 `iroot` 验证，$c$ 确实是 $17$ 次完美幂，从而可直接开根获取 flag。

## Flag
`INSA{(I)NSA_W0uld_bE_pr0uD}`
