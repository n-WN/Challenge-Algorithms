import sys
from Crypto.Util.number import *
from random import *
sys.setrecursionlimit(2000)

################################################### part1 read pem
cipher = "MIIEowIBAAKCAQEAz3om77jpWFrtAUZNPT29TYCIJzH8LTGyjZT4nuEUyGOpBXdRIaC46+jVBpkrk4vMGARJPw1j6hWM50WlI8Qq/siRU3ut2hXDeoLHugxJZEkDsRxCN26kHBMZNs5PQWKLHM1P4p70jVrfzrI7NluKnqiwLMXWP+93iUdx1OIuB3Rl/SCd/FPhy4t9dvZBYNkuHQKjY+AqandWqJLkGjJpn3K8EV036g9FchQG74cx1JXrFJu0LqAMo0qv8XqhMItDGnjx0cvFzqhVp3gg/xx3KT4++PkvLJiRNHVlQGECt1tdqsoP6wWd5RRxQlOcqkZZ8Ynpc0VVfI0xi+F7ELCk+QIDAQA?A??BA?3?a?????3??4?Y?a??????????n????C?y???P??a?4?rX??p?6?????????x???rzz?c?X??????????????yp????c??Fs????????????????????jM??????5?aGv?A?????tCD?L???pYzs???f?li???F?????????vk?????c?????uS????????Z??E????????????????GJ?????hh??/?yX??C??p???X?????s??Wv?N4?7P???????o?W?????r2??s?6?L?????Y???????????s?EXs????7?K?????R???p????GBQ??I?u?????11???Y??????EA???i??aS???j??l?????????y???t?f?F?H9??i4??0???????q?8e??Y?????v??????Q???????????DLUk??M????????F???????K??U??tQ?5?rCl????7????T?????4?7BzRd????7W??????0???M????i?Z??w???c???E??UV????????b?g??h?5???????????????Ab?????Bo?q?I??????iMt???????Gq?????Vx??????????????Gk?c??????0???c?mz?6?????3?4z??iXp?f??i??sbI?????vA2JV?J?Per??????0???????????Q???cX??gYB??????2?e????J?d?3?y?9?????D??????h????EmA1Y?csU???D?z?u??9??R?S9J4eyT?????j?V1??g?t?Sd?????b????p????????/z??f?G?i?/V???q?D7???J?G?I?B?L?????Q????9?/???e?e???7Z?0??7j??9Q??g????/?f??7d?????q?5???m?????????????????s???b??u??Py???x??d?????r??????j?z????tB?G?7z?????yQ?ui?????t????????H?BI0???mp???HO???????Z??VK??H???????W?????V?E??Z?g????M?1????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????"
table = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'

bitstream = ""
for i in cipher:
    if(i == "?"):
        bitstream += "******"
    else:
        bitstream += bin(table.index(i))[2:].zfill(6)


################################################### part2 split params
info1 = hex(int(bitstream[:4*8],2))[2:]
bitstream = bitstream[4*8:]
info2 = hex(int(bitstream[:3*8],2))[2:]
bitstream = bitstream[3*8:]

##### n,e
infon = hex(int(bitstream[:4*8],2))[2:]
bitstream = bitstream[4*8:]
n = int(bitstream[:257*8],2)
bitstream = bitstream[257*8:]
infoe = bitstream[:2*8]
bitstream = bitstream[2*8:]
e = bitstream[:3*8] #### seems like 65537
bitstream = bitstream[3*8:]
e = 65537

##### d
infod = bitstream[:4*8]
bitstream = bitstream[4*8:]
d = bitstream[:256*8]
bitstream = bitstream[256*8:]

##### p,q
infop = bitstream[:3*8]
bitstream = bitstream[3*8:]
p = bitstream[:129*8][8:]
bitstream = bitstream[129*8:]
infoq = bitstream[:3*8]
bitstream = bitstream[3*8:]
q = bitstream[:129*8]
bitstream = bitstream[129*8:]

##### dp,dq
infodp = bitstream[:3*8]
bitstream = bitstream[3*8:]
dp = bitstream[:128*8][8:]
bitstream = bitstream[128*8:]
infodq = bitstream[:3*8]
bitstream = bitstream[3*8:]
dq = bitstream[:129*8]
bitstream = bitstream[129*8:]

##### p_invq(no more)
##### maybe some additional change