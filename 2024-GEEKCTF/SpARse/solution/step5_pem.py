from Crypto.Util.number import *
from Crypto.PublicKey import RSA
from hashlib import md5

p = 147265078724969536365832804097158908382797954720876979653011951728406956112387192598824544012306646169035006144198481048711301331247260259281889124056472140003652896595645729235440361839211945606851933815085064600602384039806104472396638159553493474999959228820209555647809413406679561108752796856362130322823
q = 177853193696537602949543516363698051482015780601784878746924982714954417325534763064519601202059344904600445475536028577444032451210441011604812638239514702264403873572939796175627691144179401358323424660942530032692235257344002043472924610196358592525530975564329781167566090856393060393104676776509528699263
n = 26191564571207865803659079386216562920365743937051163433571210679225063647091082587257715669756485899193035208469976035738059784724348440070923338255026181997563861328562376469415513279917957395542741541429134095225386135220540927874676394354088360479481955915341958270722056286102261431573282803952793459642793864316123517546752697514637037955503796798930707520651108244395501602445588782475135899939892422822256499112247770956183176429072812823174574240664993265247180146106488076712548920459190957713108289707082714400895643134613721697077267869186086353168834023098632217473990464991482806559422568127693472179449
e = 65537

phi = (p-1)*(q-1)
d = inverse(e,phi)
dp = d % (p-1)
dq = d % (q-1)
qinvp = inverse(q,p)

rsa_key = RSA.construct((n,e,d,p,q))
print(rsa_key.exportKey().decode("utf-8"))

with open(r"privkey.pem","rb") as f:
    c = f.read()

c = c.replace(b"\r\n",b"\n")  #because task's command is linux
print(md5(c).hexdigest())

#flag{d13b8e56805cf71cb75789dda1816587}