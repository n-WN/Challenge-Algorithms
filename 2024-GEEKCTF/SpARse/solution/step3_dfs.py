################################################### part3 get k,kp,kq(using sparse_solve_k_kp_kq)
k = 39770
d = "0111110111100111011010001001110101101100100111101101110111101001001111111000110111011000011101011010001011000110010001101000110000110011100001010110110000010011100111110010111001100101110011000010111010110010110010100011010011001111111011011110011010110100111000111010101011010111011111110011101001100010111010000001010011110000110100111110010100001111001010100010110001111101010101110011101011110011110011101110011100011110010111110001010101111100010000100110011101001110000100100010101010100100001011100101101100110010101001110100110111111011111011011100001000111100000101101100010111001111011110110001100001100001110000000101111111000101000101110010001001110001001111011001010110011001111001001010100011001100110001100010111001000110000000000011111001110011011010000110101111110000000000111001110001001000010011011010101101000010000011000011001011001000011000011011101001011000110011101100001111111101001001011111101111100101100010100110000001111110000101110001001000001101011100101111110001110110110011001110101111100100******************************011100******************************101110010010************************************************011001************000100************************************************************************************************000110001001******************************100001100001************111111******110010010111************000010************101001******************010111******************************101100************010110101111******001101111000******111011001111******************************************101000******010110******************************101011110110************101100******111010******001011******************************011000******************************************************************101100******000100010111101100************************111011******001010******************************010001******************101001************************000110000001010000************001000******101110******************************110101110101******************011000****************"
# kp,kq = 64743,30590
kq, kp = 64743, 30590


################################################### part4 dfs
pbits = 1024
P, Q, DP, DQ, D = p[::-1], q[::-1], dp[::-1], dq[::-1], d[::-1]


def find(pl, ql, dl, dpl, dql, h):
    if h == 700:
        print(pl)
    ######## check
    if h == pbits:
        pp = int(pl, 2)
        if n % pp == 0:
            print(pp)
            print(n // pp)
            exit()
        return

    ######## prune
    if h > 0:
        pi = int(pl, 2)
        qi = int(ql, 2)
        di = int(dl, 2)
        dpi = int(dpl, 2)
        dqi = int(dql, 2)
        mask = 2**h

        if pi * qi % mask != n % mask:
            return
        if e * di % mask != (k * (n - pi - qi + 1) + 1) % mask:
            return
        if e * dpi % mask != (kp * (pi - 1) + 1) % mask:
            return
        if e * dqi % mask != (kq * (qi - 1) + 1) % mask:
            return

    ######## search
    pos_p = ["0", "1"] if P[h] == "*" else [P[h]]
    pos_q = ["0", "1"] if Q[h] == "*" else [Q[h]]
    pos_d = ["0", "1"] if D[h] == "*" else [D[h]]
    pos_dp = ["0", "1"] if DP[h] == "*" else [DP[h]]
    pos_dq = ["0", "1"] if DQ[h] == "*" else [DQ[h]]

    for ii in pos_p:
        for jj in pos_q:
            for kk in pos_d:
                for mm in pos_dp:
                    for nn in pos_dq:
                        find(ii + pl, jj + ql, kk + dl, mm + dpl, nn + dql, h + 1)


find("", "", "", "", "", 0)
