#!/usr/bin/env python3
from random import *

# from secret import FLAG
from Crypto.Util.number import *

import os

FLAG = os.getenv("FLAG", "flag{test_flag}").encode()

m = bytes_to_long(FLAG)
a = [35, 51, 91, 115, 123, 187, 235, 267, 403, 427]  # 这些数都是 3 mod 4 的合数
D = choice(a)  # D = 123
print(f"D = {D}")
while True:
    V = getRandomInteger(
        2048
    )  # Crypto.Util.number.getRandomInteger(N) 生成一个 N 比特的随机数
    numbers = D * V**2 + 1
    if numbers % 4 == 0:
        p = numbers // 4
        if isPrime(p):
            q = getPrime(2048)
            n = p * q
            e = 0x10001
            c = pow(m, e, n)
            print(f"n = {n}", "\n", f"e = {e}", "\n", f"c = {c}")
            exit(0)
        else:
            print("numbers is not Prime!!!")
    else:
        print("It is not divisible by 4!!!")


"""
n = 179805222636761752757361154562634908692714969438787703291560723272180917873957032029075680184814717636695633783665226939991856475416908142117188928100831144410537484015186461708647984772539782897289900390505981438964034973724249648079776595096831147121743213317447252394196921227347393766970308502240714104646365383012693770799987702610048308829729532066239851725564228463064736664980679208046658376357238261620688447846692870087699876971915296306572055244135977894845925074737767197233751375934008186241268732504872650623206108914436074142043185934318135439452832665045474868726056613274410377610093182710077494573919012604358578806807190086623011196257944007644289114422362079728926649697418008217319377851183267117179830076718684411634379417202167686611679073399640700430713037672521514239009790737588583941772621302941935073764462809662340867075259148007423967398617859175185794637426255104426383616220179212301282442929601472187614352616732191886261240225546285543846317003990597813415038329109987475211637563232165080434348999028615381756738514836543303297218833560232740695475098129566945403531157042723511173889452646196576476396069189597370489222801364385110424042835167378654185959234167513363881630032499410408142490050523505714446242986080384561332356217377569920812544236670616867458511774827213359432844833417927811150298255386353019076226247192584164602527266748960491422140760800109416583616853012067405948977905023148887589899259026289641578147092123647422532706164037028723294121150661719144719215829432904611634229157420010084565168831999800250798767703806978794507117695947457748926065418937230374659808159278588410075566588191647912423967810283454808600918820282648533814887290147659652660109167288039667308315978842884133825908258910606710815080145817812883394816795695034281929431992105017441095246860633904919152484705134904933
e = 65537
c = 74192640697292509026944762080565172695458669338619017098346206765182482335431438152788166359328136758898348126969912296141315437100865596926856599353321681347718167349735190987905970012548813726897123037448507794510916986099137783080607737148355646160314729600491786158663766771342778488378761787230846181590218239135984681778403035505202499521300248968702499200120686076864324806395679036601422646710756132165199046199540732852053602566479407526244112338208195377241157146779450149414960198469632551569036545056134150069364974900646248640000532909496660270938534896979699717366275720932063829717895074110031747611706315943345617561481224800320522549217811984035979282017413305787370501527639716519890398998498352203265395169336675309208618209245403557383398724826791971021240021657713699582580485494146393888841226519189358196018524945005370600737529581041372318875718929832039840447986173799636603771566111169543404795875055407330958319770539823100108761742312271042306961778450966152502880659969080718438791789901655470793289559038217680106658642332119690959294770912938714714970787457579475705542222082340724434655747451479785793059557304150960458427101462338094515384805344214291099953748915133312509512056777328441176165942252298245277444189486937254711112875577315115396793350600547391459616733962475318213948182289833949123523158353437573677589964126857863627909200956380510011874304306582465579748540635718243364637276280650000361576797909227370215732593021981477318153065263880214863764939348677919588979273700590560132304456251815706383517974243679532717857694024433970918310047565436743268261509445888660259078726755985600017980248822187350625199874207254220392654134841463251139641938202974109673774476665131212291375435833654822207464105018489511653095877744021237494275804279082034105848761850744736285053144952929429092897544914800195
"""
